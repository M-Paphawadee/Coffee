<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>COFFEELINE</title>
<style>
  *{box-sizing:border-box;margin:0;padding:0}
  :root{
    --brown:#8B4513;--brown2:#D2691E;--muted:#6c757d;--ok:#28a745;--warn:#ffc107;--danger:#dc3545;--info:#0d6efd;
    --bg1:#f5f7fa;--bg2:#c3cfe2;
  }
  body{font-family:'Segoe UI',Tahoma,Geneva,Verdana,sans-serif;background:linear-gradient(135deg,var(--bg1) 0%,var(--bg2) 100%);min-height:100vh}
  a{color:inherit;text-decoration:none}
  /* header */
  .header{display:none;background:linear-gradient(135deg,var(--brown) 0%,var(--brown2) 100%);color:#fff;padding:14px 20px;align-items:center;justify-content:space-between}
  .brand{font-weight:700;font-size:1.2rem}
  .userbox{display:flex;gap:10px;align-items:center}
  .chip{background:rgba(255,255,255,.15);padding:6px 10px;border-radius:999px}
  .btn{border:none;border-radius:10px;padding:8px 12px;cursor:pointer}
  .btn:hover{opacity:.9}
  .btn-ghost{background:rgba(255,255,255,.25);color:#fff}
  /* container */
  .wrap{max-width:1200px;margin:0 auto;padding:22px}
  .cards{display:grid;grid-template-columns:repeat(auto-fit,minmax(320px,1fr));gap:18px;margin-top:14px}
  .card{background:#fff;border-radius:14px;padding:18px;box-shadow:0 6px 18px rgba(0,0,0,.08);border-left:5px solid var(--brown)}
  .card .hd{display:flex;gap:10px;align-items:center;border-bottom:1px solid #eee;padding-bottom:10px;margin-bottom:10px}
  .li{display:flex;gap:10px;align-items:center;background:#f8f9fa;border-radius:8px;padding:10px;margin-top:10px;cursor:pointer}
  .li:hover{background:#eef1f4;transform:translateX(3px)}
  .dot{color:var(--brown)}
  .badge{margin-left:auto;background:var(--danger);color:#fff;border-radius:999px;padding:2px 7px;font-size:.72rem;min-width:18px;text-align:center}
  /* quick stats */
  .stats{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:14px;margin-bottom:16px}
  .stat{background:#fff;border-radius:12px;padding:14px;box-shadow:0 5px 14px rgba(0,0,0,.06);text-align:center}
  .stat h3{color:var(--brown);font-size:1.4rem}
  .stat p{color:#666}
  /* login */
  .center{min-height:100vh;display:flex;align-items:center;justify-content:center;padding:20px}
  .login{width:100%;max-width:430px;background:#fff;border-radius:16px;padding:22px;box-shadow:0 10px 30px rgba(0,0,0,.12)}
  .login h1{margin-bottom:4px}
  .login small{color:#666}
  .row{display:flex;flex-direction:column;gap:6px;margin-top:12px}
  .row input{padding:10px 12px;border:1px solid #dcdcdc;border-radius:10px}
  .row .hint{font-size:.82rem;color:#666}
  .btn-full{width:100%;padding:11px 14px;border:none;border-radius:12px;background:var(--brown);color:#fff;font-weight:600;margin-top:12px}
  .btn-full.secondary{background:var(--info)}
  .mt{margin-top:16px}
  /* page */
  .page{display:none}
  .crumbs{font-size:.9rem;color:#666;margin-bottom:10px}
  .title{display:flex;justify-content:space-between;align-items:center;margin-bottom:10px}
  .title h2{font-size:1.1rem}
  .grid2{display:grid;grid-template-columns:1fr;gap:12px}
  .form{background:#fff;border-radius:12px;padding:14px;box-shadow:0 6px 16px rgba(0,0,0,.06)}
  .form .g{display:grid;grid-template-columns:1fr 1fr;gap:10px}
  .form label{font-size:.88rem;color:#333}
  .form input,.form select,.form textarea{width:100%;padding:10px;border:1px solid #dcdcdc;border-radius:10px}
  .table{width:100%;border-collapse:collapse;background:#fff;border-radius:12px;overflow:hidden;box-shadow:0 6px 16px rgba(0,0,0,.06)}
  .table th,.table td{padding:10px;border-bottom:1px solid #eee;text-align:left}
  .pill{padding:4px 8px;border-radius:999px;font-size:.78rem}
  .pill.ok{background:#e9f9ee;color:#177a33;border:1px solid #bff0c9}
  .pill.warn{background:#fff6dd;color:#9b7b0a;border:1px solid #ffe193}
  /* drawer chat (‡∏Ñ‡∏á‡πÑ‡∏ß‡πâ‡∏à‡∏≤‡∏Å‡πÄ‡∏î‡∏¥‡∏° ‡πÅ‡∏ö‡∏ö‡∏¢‡πà‡∏≠) */
  .drawer{position:fixed;top:0;right:-420px;width:420px;max-width:100vw;height:100vh;background:#fff;box-shadow:-6px 0 24px rgba(0,0,0,.15);transition:right .35s;z-index:50;display:flex;flex-direction:column;border-left:4px solid var(--info)}
  .drawer.open{right:0}
  .drawer .hd{display:flex;justify-content:space-between;align-items:center;padding:12px 14px;background:linear-gradient(135deg,var(--info),#57a0ff);color:#fff}
  .drawer .body{padding:12px;overflow:auto;flex:1;background:#f6f8fb}
  .drawer .foot{padding:10px;border-top:1px solid #eee;display:flex;gap:8px}
  .drawer input{flex:1;padding:10px;border:1px solid #dcdcdc;border-radius:10px}
  .primary{background:var(--info);color:#fff}
  .danger{background:var(--danger);color:#fff}
  /* color stripes for modules */
  .harvest{border-left-color:#28a745}.production{border-left-color:#fd7e14}.quality{border-left-color:#dc3545}.warehouse{border-left-color:#6f42c1}.order{border-left-color:#007bff}.logistics{border-left-color:#20c997}.reports{border-left-color:#ffc107}
</style>
</head>
<body>

<!-- ======= LOGIN ======= -->
<div id="view-login" class="center">
  <form class="login" onsubmit="return doLogin(event)">
    <h1>‚òï COFFEELINE</h1>
    <small>‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Å‡∏≤‡∏£‡∏ú‡∏•‡∏¥‡∏ï/‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå</small>
    <div class="row">
      <label>‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ</label>
      <input id="u" placeholder="admin ‡∏´‡∏£‡∏∑‡∏≠ staff" required>
    </div>
    <div class="row">
      <label>‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô</label>
      <input id="p" type="password" placeholder="‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 4 ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£" minlength="4" required>
      <div class="hint">‡πÄ‡∏î‡πÇ‡∏°‡πà: ‡πÉ‡∏ä‡πâ user ‡πÉ‡∏î‡∏Å‡πá‡πÑ‡∏î‡πâ ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡∏à‡∏≥‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡πÑ‡∏ß‡πâ‡πÉ‡∏ô‡πÄ‡∏ö‡∏£‡∏≤‡∏ß‡πå‡πÄ‡∏ã‡∏≠‡∏£‡πå</div>
    </div>
    <button class="btn-full" type="submit">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</button>
    <button class="btn-full secondary" type="button" onclick="fillDemo()">‡πÉ‡∏™‡πà‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏î‡πÇ‡∏°‡πà</button>
  </form>
</div>

<!-- ======= APP HEADER ======= -->
<header id="app-header" class="header">
  <div class="brand"><a href="#/dashboard">‚òï COFFEELINE</a></div>
  <div class="userbox">
    <span class="chip">üë§ <span id="who">‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ</span></span>
    <button class="btn btn-ghost" onclick="logout()">‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö</button>
  </div>
</header>

<!-- ======= DASHBOARD ======= -->
<main id="view-dashboard" class="page">
  <div class="wrap">
    <div class="stats">
      <div class="stat"><h3 id="kgToday">1,245</h3><p>‡∏Å‡∏¥‡πÇ‡∏•‡∏Å‡∏£‡∏±‡∏°‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</p></div>
      <div class="stat"><h3>98.5%</h3><p>‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡∏ú‡πà‡∏≤‡∏ô‡πÄ‡∏Å‡∏ì‡∏ë‡πå</p></div>
      <div class="stat"><h3 id="ordersWait">15</h3><p>‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡∏£‡∏≠‡∏à‡∏±‡∏î‡∏™‡πà‡∏á</p></div>
      <div class="stat"><h3>‚Çø125K</h3><p>‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</p></div>
    </div>

    <div class="cards">
      <!-- ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß -->
      <section class="card harvest">
        <div class="hd"><span>üå±</span><strong>‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß</strong></div>
        <div class="li" onclick="go('harvest-record')"><span class="dot">‚ñ∂</span>‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß</div>
        <div class="li" onclick="go('raw-material-track')"><span class="dot">‚ñ∂</span>‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ì‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏î‡∏¥‡∏ö‡πÄ‡∏Ç‡πâ‡∏≤</div>
        <div class="li" onclick="go('bean-quality-check')"><span class="dot">‚ñ∂</span>‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡πÄ‡∏°‡∏•‡πá‡∏î</div>
      </section>

      <!-- ‡∏Å‡∏£‡∏∞‡∏ö‡∏ß‡∏ô‡∏Å‡∏≤‡∏£‡∏ú‡∏•‡∏¥‡∏ï -->
      <section class="card production">
        <div class="hd"><span>‚öôÔ∏è</span><strong>‡∏Å‡∏£‡∏∞‡∏ö‡∏ß‡∏ô‡∏Å‡∏≤‡∏£‡∏ú‡∏•‡∏¥‡∏ï</strong></div>
        <div class="li" onclick="go('cleaning-record')"><span class="dot">‚ñ∂</span>‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∞‡∏≠‡∏≤‡∏î</div>
        <div class="li" onclick="go('sorting-record')"><span class="dot">‚ñ∂</span>‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏Ñ‡∏±‡∏î‡πÅ‡∏¢‡∏Å‡πÄ‡∏°‡∏•‡πá‡∏î</div>
        <div class="li" onclick="go('resting-record')"><span class="dot">‚ñ∂</span>‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡∏Å‡∏≤‡∏£‡∏û‡∏±‡∏Å‡πÄ‡∏°‡∏•‡πá‡∏î</div>
        <div class="li" onclick="go('hulling-roasting')"><span class="dot">‚ñ∂</span>‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏∞‡πÄ‡∏ó‡∏≤‡∏∞‡πÄ‡∏õ‡∏•‡∏∑‡∏≠‡∏Å‡πÅ‡∏•‡∏∞‡∏Ñ‡∏±‡πà‡∏ß</div>
      </section>

      <!-- ‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û -->
      <section class="card quality">
        <div class="hd"><span>üîç</span><strong>‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û</strong></div>
        <div class="li" onclick="go('quality-inspection')"><span class="dot">‚ñ∂</span>‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û</div>
        <div class="li" onclick="go('material-tracking')"><span class="dot">‚ñ∂</span>‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ì‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏î‡∏¥‡∏ö‡πÄ‡∏Ç‡πâ‡∏≤</div>
        <div class="li" onclick="go('bean-quality')"><span class="dot">‚ñ∂</span>‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡πÄ‡∏°‡∏•‡πá‡∏î</div>
      </section>

      <!-- ‡∏Ñ‡∏•‡∏±‡∏á‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ -->
      <section class="card warehouse">
        <div class="hd"><span>üì¶</span><strong>‡∏Ñ‡∏•‡∏±‡∏á‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÅ‡∏•‡∏∞‡∏ö‡∏£‡∏£‡∏à‡∏∏‡∏†‡∏±‡∏ì‡∏ë‡πå</strong></div>
        <div class="li" onclick="go('warehouse-harvest')"><span class="dot">‚ñ∂</span>‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß (‡∏Ñ‡∏•‡∏±‡∏á)</div>
        <div class="li" onclick="go('warehouse-tracking')"><span class="dot">‚ñ∂</span>‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ì‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏î‡∏¥‡∏ö‡πÄ‡∏Ç‡πâ‡∏≤ (‡∏Ñ‡∏•‡∏±‡∏á)</div>
        <div class="li" onclick="go('warehouse-quality')"><span class="dot">‚ñ∂</span>‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡πÄ‡∏°‡∏•‡πá‡∏î (‡∏Ñ‡∏•‡∏±‡∏á)</div>
      </section>

      <!-- ‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠/‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£ -->
      <section class="card order">
        <div class="hd"><span>üìã</span><strong>‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡πÅ‡∏•‡∏∞‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£</strong></div>
        <div class="li" onclick="go('order-record')"><span class="dot">‚ñ∂</span>‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠</div>
        <div class="li" onclick="go('order-status')"><span class="dot">‚ñ∂</span>‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠ <span id="bdg-ord" class="badge">5</span></div>
        <div class="li" onclick="go('documents')"><span class="dot">‚ñ∂</span>‡∏à‡∏±‡∏î‡∏ó‡∏≥‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£ (‡πÉ‡∏ö‡∏Å‡∏≥‡∏Å‡∏±‡∏ö‡∏†‡∏≤‡∏©‡∏µ / ‡πÉ‡∏ö‡∏™‡πà‡∏á‡∏Ç‡∏≠‡∏á)</div>
        <div class="li" onclick="toggleChat(true)"><span class="dot">‚ñ∂</span>‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÅ‡∏ä‡∏ó‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡∏à‡∏≤‡∏Å‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤ <span id="bdg-chat" class="badge">3</span></div>
      </section>

      <!-- ‡πÇ‡∏•‡∏à‡∏¥‡∏™‡∏ï‡∏¥‡∏Å‡∏™‡πå -->
      <section class="card logistics">
        <div class="hd"><span>üöõ</span><strong>‡∏Å‡∏≤‡∏£‡∏Ç‡∏ô‡∏™‡πà‡∏á‡πÅ‡∏•‡∏∞‡πÇ‡∏•‡∏à‡∏¥‡∏™‡∏ï‡∏¥‡∏Å‡∏™‡πå</strong></div>
        <div class="li" onclick="go('transport-pickup')"><span class="dot">‚ñ∂</span>‡∏£‡∏ñ‡∏Ç‡∏ô‡∏™‡πà‡∏á‡∏£‡∏±‡∏ö‡πÄ‡∏°‡∏•‡πá‡∏î‡∏Å‡∏≤‡πÅ‡∏ü</div>
        <div class="li" onclick="go('route-schedule')"><span class="dot">‚ñ∂</span>‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏™‡πâ‡∏ô‡∏ó‡∏≤‡∏á‡πÅ‡∏•‡∏∞‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏à‡∏±‡∏î‡∏™‡πà‡∏á</div>
        <div class="li" onclick="go('delivery-confirm')"><span class="dot">‚ñ∂</span>‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡πÉ‡∏´‡πâ‡πÇ‡∏£‡∏á‡∏á‡∏≤‡∏ô</div>
      </section>

      <!-- ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô -->
      <section class="card reports">
        <div class="hd"><span>üìà</span><strong>‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡πÅ‡∏•‡∏∞‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå</strong></div>
        <div class="li" onclick="go('harvest-report')"><span class="dot">‚ñ∂</span>‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß</div>
        <div class="li" onclick="go('material-report')"><span class="dot">‚ñ∂</span>‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ì‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏î‡∏¥‡∏ö</div>
        <div class="li" onclick="go('quality-report')"><span class="dot">‚ñ∂</span>‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡πÄ‡∏°‡∏•‡πá‡∏î</div>
        <div class="li" onclick="go('trend-analysis')"><span class="dot">‚ñ∂</span>‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÅ‡∏ô‡∏ß‡πÇ‡∏ô‡πâ‡∏°‡∏Å‡∏≤‡∏£‡∏ú‡∏•‡∏¥‡∏ï‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏Ç‡∏≤‡∏¢</div>
      </section>
    </div>
  </div>
</main>

<!-- ======= GENERIC PAGE (‡∏ó‡∏∏‡∏Å‡πÄ‡∏°‡∏ô‡∏π) ======= -->
<main id="view-page" class="page">
  <div class="wrap">
    <div class="crumbs"><a href="#/dashboard">‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å</a> ‚Ä∫ <span id="crumb">‡πÄ‡∏°‡∏ô‡∏π</span></div>
    <div class="title">
      <h2 id="page-title">‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏°‡∏ô‡∏π</h2>
      <div>
        <button class="btn" onclick="history.back()">‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö</button>
        <button class="btn primary" onclick="savePage()">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
      </div>
    </div>

    <div class="grid2">
      <section class="form">
        <h3 style="margin-bottom:8px">‡∏ü‡∏≠‡∏£‡πå‡∏°</h3>
        <div id="form-area" class="g"></div>
      </section>

      <section>
        <table class="table" id="tbl">
          <thead><tr id="th"></tr></thead>
          <tbody id="tb"></tbody>
        </table>
      </section>
    </div>
  </div>
</main>

<!-- ======= CHAT DRAWER (‡πÄ‡∏î‡∏¥‡∏°) ======= -->
<aside id="chat" class="drawer" aria-hidden="true">
  <div class="hd"><strong>‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÅ‡∏ä‡∏ó‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå</strong><button class="btn danger" onclick="toggleChat(false)">‡∏õ‡∏¥‡∏î</button></div>
  <div id="chatBody" class="body"></div>
  <div class="foot">
    <input id="chatInput" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°...">
    <button class="btn primary" onclick="sendChat()">‡∏™‡πà‡∏á</button>
  </div>
</aside>

<script>
/* ====== DATA: routes + field presets ====== */
const routes = {
  // 2.2.1
  'harvest-record': {title:'‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß', fields:[
    {k:'LotNumber', label:'‡∏£‡∏´‡∏±‡∏™‡∏•‡πá‡∏≠‡∏ï'}, {k:'Date',label:'‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà'}, {k:'BeanType',label:'‡∏ä‡∏ô‡∏¥‡∏î‡πÄ‡∏°‡∏•‡πá‡∏î'}, {k:'WeightKg',label:'‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å(‡∏Å‡∏Å.)'}
  ], cols:['‡∏£‡∏´‡∏±‡∏™','‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà','‡∏ä‡∏ô‡∏¥‡∏î','‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å(‡∏Å‡∏Å.)']},
  'raw-material-track': {title:'‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ì‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏î‡∏¥‡∏ö‡πÄ‡∏Ç‡πâ‡∏≤', fields:[
    {k:'InboundDate',label:'‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏ö‡πÄ‡∏Ç‡πâ‡∏≤'}, {k:'Supplier',label:'‡∏ú‡∏π‡πâ‡∏™‡πà‡∏á‡∏°‡∏≠‡∏ö'}, {k:'QuantityKg',label:'‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ì(‡∏Å‡∏Å.)'}
  ], cols:['‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏ö‡πÄ‡∏Ç‡πâ‡∏≤','‡∏ú‡∏π‡πâ‡∏™‡πà‡∏á‡∏°‡∏≠‡∏ö','‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ì(‡∏Å‡∏Å.)']},
  'bean-quality-check': {title:'‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡πÄ‡∏°‡∏•‡πá‡∏î', fields:[
    {k:'Moisture',label:'‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡∏∑‡πâ‡∏ô(%)'}, {k:'Defects',label:'‡∏™‡∏¥‡πà‡∏á‡πÄ‡∏à‡∏∑‡∏≠‡∏õ‡∏ô(%)'}, {k:'Grade',label:'‡πÄ‡∏Å‡∏£‡∏î'}
  ], cols:['‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡∏∑‡πâ‡∏ô(%)','‡∏™‡∏¥‡πà‡∏á‡πÄ‡∏à‡∏∑‡∏≠‡∏õ‡∏ô(%)','‡πÄ‡∏Å‡∏£‡∏î']},

  // 2.2.2
  'cleaning-record': {title:'‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∞‡∏≠‡∏≤‡∏î', fields:[
    {k:'Start',label:'‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°'}, {k:'End',label:'‡πÄ‡∏ß‡∏•‡∏≤‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î'}, {k:'Method',label:'‡∏ß‡∏¥‡∏ò‡∏µ‡∏ó‡∏≥‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∞‡∏≠‡∏≤‡∏î'}
  ], cols:['‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°','‡πÄ‡∏ß‡∏•‡∏≤‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î','‡∏ß‡∏¥‡∏ò‡∏µ']},
  'sorting-record': {title:'‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏Ñ‡∏±‡∏î‡πÅ‡∏¢‡∏Å‡πÄ‡∏°‡∏•‡πá‡∏î', fields:[
    {k:'Batch',label:'‡πÄ‡∏•‡∏Ç‡∏ä‡∏∏‡∏î'}, {k:'Method',label:'‡∏ß‡∏¥‡∏ò‡∏µ‡∏Ñ‡∏±‡∏î‡πÅ‡∏¢‡∏Å'}, {k:'OutputKg',label:'‡∏ú‡∏•‡∏ú‡∏•‡∏¥‡∏ï(‡∏Å‡∏Å.)'}
  ], cols:['‡πÄ‡∏•‡∏Ç‡∏ä‡∏∏‡∏î','‡∏ß‡∏¥‡∏ò‡∏µ‡∏Ñ‡∏±‡∏î‡πÅ‡∏¢‡∏Å','‡∏ú‡∏•‡∏ú‡∏•‡∏¥‡∏ï(‡∏Å‡∏Å.)']},
  'resting-record': {title:'‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡∏Å‡∏≤‡∏£‡∏û‡∏±‡∏Å‡πÄ‡∏°‡∏•‡πá‡∏î', fields:[
    {k:'RestStart',label:'‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏û‡∏±‡∏Å'}, {k:'RestEnd',label:'‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î‡∏û‡∏±‡∏Å'}, {k:'Temp',label:'‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥(¬∞C)'}
  ], cols:['‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏û‡∏±‡∏Å','‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î‡∏û‡∏±‡∏Å','‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥']},
  'hulling-roasting': {title:'‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏∞‡πÄ‡∏ó‡∏≤‡∏∞‡πÄ‡∏õ‡∏•‡∏∑‡∏≠‡∏Å‡πÅ‡∏•‡∏∞‡∏Ñ‡∏±‡πà‡∏ß', fields:[
    {k:'RoastLevel',label:'‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏Ñ‡∏±‡πà‡∏ß'}, {k:'TimeMin',label:'‡πÄ‡∏ß‡∏•‡∏≤‡∏Ñ‡∏±‡πà‡∏ß(‡∏ô‡∏≤‡∏ó‡∏µ)'},{k:'Loss%',label:'Loss (%)'}
  ], cols:['‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Ñ‡∏±‡πà‡∏ß','‡πÄ‡∏ß‡∏•‡∏≤‡∏Ñ‡∏±‡πà‡∏ß(‡∏ô‡∏≤‡∏ó‡∏µ)','Loss (%)']},

  // 2.2.3
  'quality-inspection': {title:'‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û', fields:[
    {k:'Param',label:'‡∏û‡∏≤‡∏£‡∏≤‡∏°‡∏¥‡πÄ‡∏ï‡∏≠‡∏£‡πå'}, {k:'Value',label:'‡∏Ñ‡πà‡∏≤'}, {k:'Result',label:'‡∏ú‡∏•'}
  ], cols:['‡∏û‡∏≤‡∏£‡∏≤‡∏°‡∏¥‡πÄ‡∏ï‡∏≠‡∏£‡πå','‡∏Ñ‡πà‡∏≤','‡∏ú‡∏•']},
  'material-tracking': {title:'‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ì‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏î‡∏¥‡∏ö‡πÄ‡∏Ç‡πâ‡∏≤', fields:[
    {k:'Date',label:'‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà'}, {k:'Item',label:'‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£'}, {k:'Qty',label:'‡∏à‡∏≥‡∏ô‡∏ß‡∏ô'}
  ], cols:['‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà','‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£','‡∏à‡∏≥‡∏ô‡∏ß‡∏ô']},
  'bean-quality': {title:'‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡πÄ‡∏°‡∏•‡πá‡∏î', fields:[
    {k:'Sample',label:'‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á'}, {k:'Score',label:'‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô'}, {k:'Note',label:'‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏'}
  ], cols:['‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á','‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô','‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏']},

  // 2.2.4
  'warehouse-harvest': {title:'‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß (‡∏Ñ‡∏•‡∏±‡∏á)', fields:[
    {k:'Ref',label:'‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß'}, {k:'Loc',label:'‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡πá‡∏ö'}, {k:'QtyKg',label:'‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ì(‡∏Å‡∏Å.)'}
  ], cols:['‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á','‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡πá‡∏ö','‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ì(‡∏Å‡∏Å.)']},
  'warehouse-tracking': {title:'‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ì‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏î‡∏¥‡∏ö‡πÄ‡∏Ç‡πâ‡∏≤ (‡∏Ñ‡∏•‡∏±‡∏á)', fields:[
    {k:'Date',label:'‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà'}, {k:'Rack',label:'‡∏ä‡∏±‡πâ‡∏ô‡∏ß‡∏≤‡∏á'}, {k:'Qty',label:'‡∏à‡∏≥‡∏ô‡∏ß‡∏ô'}
  ], cols:['‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà','‡∏ä‡∏±‡πâ‡∏ô‡∏ß‡∏≤‡∏á','‡∏à‡∏≥‡∏ô‡∏ß‡∏ô']},
  'warehouse-quality': {title:'‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡πÄ‡∏°‡∏•‡πá‡∏î (‡∏Ñ‡∏•‡∏±‡∏á)', fields:[
    {k:'Lot',label:'‡∏•‡πá‡∏≠‡∏ï'}, {k:'QC',label:'‡∏ú‡∏• QC'}, {k:'Expire',label:'‡∏ß‡∏±‡∏ô‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏'}
  ], cols:['‡∏•‡πá‡∏≠‡∏ï','‡∏ú‡∏• QC','‡∏ß‡∏±‡∏ô‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏']},

  // 2.2.5
  'order-record': {title:'‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠', fields:[
    {k:'OrderNo',label:'‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠'}, {k:'Customer',label:'‡∏ä‡∏∑‡πà‡∏≠‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤'}, {k:'Amount',label:'‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°'}
  ], cols:['‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠','‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤','‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°']},
  'order-status': {title:'‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠', fields:[
    {k:'OrderNo',label:'‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠'}, {k:'Status',label:'‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞'}, {k:'ETA',label:'‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏™‡πà‡∏á'}
  ], cols:['‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà','‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞','‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏™‡πà‡∏á']},
  'documents': {title:'‡∏à‡∏±‡∏î‡∏ó‡∏≥‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£', fields:[
    {k:'DocType',label:'‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£'}, {k:'IssueDate',label:'‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏≠‡∏≠‡∏Å'}, {k:'Ref',label:'‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á'}
  ], cols:['‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó','‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏≠‡∏≠‡∏Å','‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á']},

  // 2.2.6
  'transport-pickup': {title:'‡∏£‡∏ñ‡∏Ç‡∏ô‡∏™‡πà‡∏á‡∏£‡∏±‡∏ö‡πÄ‡∏°‡∏•‡πá‡∏î‡∏Å‡∏≤‡πÅ‡∏ü', fields:[
    {k:'PickupID',label:'‡πÄ‡∏•‡∏Ç‡∏£‡∏±‡∏ö‡∏Ç‡∏≠‡∏á'}, {k:'Driver',label:'‡∏Ñ‡∏ô‡∏Ç‡∏±‡∏ö'}, {k:'Vehicle',label:'‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏£‡∏ñ'}
  ], cols:['‡πÄ‡∏•‡∏Ç‡∏£‡∏±‡∏ö‡∏Ç‡∏≠‡∏á','‡∏Ñ‡∏ô‡∏Ç‡∏±‡∏ö','‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô']},
  'route-schedule': {title:'‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏™‡πâ‡∏ô‡∏ó‡∏≤‡∏á‡πÅ‡∏•‡∏∞‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏à‡∏±‡∏î‡∏™‡πà‡∏á', fields:[
    {k:'Route',label:'‡πÄ‡∏™‡πâ‡∏ô‡∏ó‡∏≤‡∏á'}, {k:'ShipDate',label:'‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡πà‡∏á'}, {k:'Stop',label:'‡∏à‡∏∏‡∏î‡πÅ‡∏ß‡∏∞'}
  ], cols:['‡πÄ‡∏™‡πâ‡∏ô‡∏ó‡∏≤‡∏á','‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡πà‡∏á','‡∏à‡∏∏‡∏î‡πÅ‡∏ß‡∏∞']},
  'delivery-confirm': {title:'‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡πÉ‡∏´‡πâ‡πÇ‡∏£‡∏á‡∏á‡∏≤‡∏ô', fields:[
    {k:'Ref',label:'‡πÄ‡∏•‡∏Ç‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£'}, {k:'Time',label:'‡πÄ‡∏ß‡∏•‡∏≤‡∏™‡πà‡∏á‡∏ñ‡∏∂‡∏á'}, {k:'Receiver',label:'‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö'}
  ], cols:['‡πÄ‡∏•‡∏Ç‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£','‡πÄ‡∏ß‡∏•‡∏≤‡∏™‡πà‡∏á‡∏ñ‡∏∂‡∏á','‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö']},

  // 2.2.7
  'harvest-report': {title:'‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß', fields:[
    {k:'From',label:'‡∏à‡∏≤‡∏Å‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà'}, {k:'To',label:'‡∏ñ‡∏∂‡∏á‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà'}, {k:'Type',label:'‡∏ä‡∏ô‡∏¥‡∏î‡πÄ‡∏°‡∏•‡πá‡∏î'}
  ], cols:['‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà','‡∏ä‡∏ô‡∏¥‡∏î','‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ì(‡∏Å‡∏Å.)']},
  'material-report': {title:'‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ì‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏î‡∏¥‡∏ö', fields:[
    {k:'From',label:'‡∏à‡∏≤‡∏Å‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà'}, {k:'To',label:'‡∏ñ‡∏∂‡∏á‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà'}, {k:'Warehouse',label:'‡∏Ñ‡∏•‡∏±‡∏á'}
  ], cols:['‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà','‡∏Ñ‡∏•‡∏±‡∏á','‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠(‡∏Å‡∏Å.)']},
  'quality-report': {title:'‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡πÄ‡∏°‡∏•‡πá‡∏î', fields:[
    {k:'From',label:'‡∏à‡∏≤‡∏Å‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà'}, {k:'To',label:'‡∏ñ‡∏∂‡∏á‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà'}, {k:'Metric',label:'‡∏ï‡∏±‡∏ß‡∏ä‡∏µ‡πâ‡∏ß‡∏±‡∏î'}
  ], cols:['‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà','‡∏ï‡∏±‡∏ß‡∏ä‡∏µ‡πâ‡∏ß‡∏±‡∏î','‡∏Ñ‡πà‡∏≤‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢']},
  'trend-analysis': {title:'‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÅ‡∏ô‡∏ß‡πÇ‡∏ô‡πâ‡∏°‡∏Å‡∏≤‡∏£‡∏ú‡∏•‡∏¥‡∏ï‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏Ç‡∏≤‡∏¢', fields:[
    {k:'Period',label:'‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤'}, {k:'Metric',label:'‡∏ï‡∏±‡∏ß‡∏ä‡∏µ‡πâ‡∏ß‡∏±‡∏î'}, {k:'Compare',label:'‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏Å‡∏±‡∏ö'}
  ], cols:['‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤','‡∏ï‡∏±‡∏ß‡∏ä‡∏µ‡πâ‡∏ß‡∏±‡∏î','‡∏ú‡∏•‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå']}
};

/* ====== AUTH ====== */
const KEY='cl_user';
function isAuthed(){return !!localStorage.getItem(KEY)}
function doLogin(e){
  e.preventDefault();
  const u=document.getElementById('u').value.trim();
  const p=document.getElementById('p').value;
  if(!u||p.length<4){alert('‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö');return false}
  const role = (u.toLowerCase()==='admin')?'‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•‡∏£‡∏∞‡∏ö‡∏ö':'‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô';
  localStorage.setItem(KEY, JSON.stringify({name:u,role}));
  route('#/dashboard');
  return false;
}
function fillDemo(){document.getElementById('u').value='admin';document.getElementById('p').value='1234'}
function logout(){
  localStorage.removeItem(KEY);
  route('#/login');
}

/* ====== ROUTER ====== */
window.addEventListener('hashchange', ()=>route(location.hash));
function route(hash){
  const h = hash || (isAuthed() ? '#/dashboard' : '#/login');
  const [ , path, arg ] = h.split('/'); // '#','path','arg'
  showView(path, arg);
}
function showView(view,arg){
  // toggle header
  document.getElementById('app-header').style.display = (view==='login')?'none':'flex';
  // toggle pages
  hideAll(['view-login','view-dashboard','view-page']);
  if(view==='login'){document.getElementById('view-login').style.display='flex';return}
  if(!isAuthed()){location.hash='#/login';return}
  const u=JSON.parse(localStorage.getItem(KEY)||'{}');
  document.getElementById('who').textContent = `${u.role} (${u.name})`;

  if(view==='dashboard'){document.getElementById('view-dashboard').style.display='block';return}
  if(view==='page'){ renderPage(arg); document.getElementById('view-page').style.display='block'; return}
  // default
  document.getElementById('view-dashboard').style.display='block';
}
function hideAll(ids){ids.forEach(id=>document.getElementById(id).style.display='none')}
function go(code){ location.hash = `#/page/${code}`; }

/* ====== PAGE RENDER ====== */
function renderPage(code){
  const cfg = routes[code];
  const title = cfg? cfg.title : '‡πÄ‡∏°‡∏ô‡∏π';
  document.getElementById('page-title').textContent = title;
  document.getElementById('crumb').textContent = title;

  // build form
  const fa = document.getElementById('form-area');
  fa.innerHTML='';
  (cfg?.fields||[]).forEach(f=>{
    const box=document.createElement('div');
    box.innerHTML = `<label>${f.label}</label><input id="f_${f.k}" placeholder="${f.label}">`;
    fa.appendChild(box);
  });

  // build table header
  const th=document.getElementById('th'); th.innerHTML='';
  (cfg?.cols||[]).forEach(c=>{
    const el=document.createElement('th'); el.textContent=c; th.appendChild(el);
  });

  // sample rows (mock)
  const tb=document.getElementById('tb'); tb.innerHTML='';
  for(let i=0;i<3;i++){
    const tr=document.createElement('tr');
    (cfg?.cols||[]).forEach((c,idx)=>{
      const td=document.createElement('td');
      td.innerHTML = idx===cfg.cols.length-1 && /‡∏ú‡∏•|‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞|‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠|‡∏Ñ‡πà‡∏≤|‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå/.test(c)
        ? `<span class="pill ${i%2? 'ok':'warn'}">${i%2? 'OK':'‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö'}</span>`
        : `‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á ${i+1}`;
      tr.appendChild(td);
    });
    tb.appendChild(tr);
  }
}
function savePage(){
  alert('‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (‡πÄ‡∏î‡πÇ‡∏°‡πà) ‚Äî ‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏£‡∏¥‡∏á‡∏à‡∏∞‡πÄ‡∏£‡∏µ‡∏¢‡∏Å API');
}

/* ====== DASHBOARD DEMO UPDATES ====== */
setInterval(()=>{
  const el=document.getElementById('kgToday');
  const v=parseInt(el.textContent.replace(/,/g,'')) + Math.floor(Math.random()*7);
  el.textContent=v.toLocaleString();
}, 4000);

/* ====== CHAT DRAWER (‡∏¢‡πà‡∏≠) ====== */
const chatEl=document.getElementById('chat'), chatBody=document.getElementById('chatBody'), chatInput=document.getElementById('chatInput');
function toggleChat(open){ chatEl.classList.toggle('open',!!open); chatEl.setAttribute('aria-hidden', open?'false':'true'); if(open) chatInput.focus() }
function sendChat(){
  const t=chatInput.value.trim(); if(!t) return;
  addChat(`‡∏â‡∏±‡∏ô: ${t}`); chatInput.value='';
}
function addChat(t){
  const d=document.createElement('div'); d.style.background='#fff'; d.style.border='1px solid #eee'; d.style.padding='8px'; d.style.marginBottom='8px'; d.textContent=t;
  chatBody.appendChild(d); chatBody.scrollTop=chatBody.scrollHeight;
}
// mock new msg
setInterval(()=>{ addChat('‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤: ‡∏Ç‡∏≠‡πÄ‡∏ä‡πá‡∏Ñ‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡∏´‡∏ô‡πà‡∏≠‡∏¢‡∏Ñ‡πà‡∏∞'); inc('bdg-chat') }, 20000);
function inc(id){const el=document.getElementById(id); el.textContent = String(parseInt(el.textContent||'0',10)+1)}

/* ====== INIT ====== */
route(location.hash);

/* ====== expose for inline buttons ====== */
window.go=go; window.savePage=savePage; window.logout=logout; window.toggleChat=toggleChat;
</script>
</body>
</html>
